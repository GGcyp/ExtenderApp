<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:t="clr-namespace:ExtenderApp.Views.Themes;assembly=ExtenderApp.Views">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/ExtenderApp.Views;component/ViewStyles.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="TorrentExpander" TargetType="Expander">
        <Style.Setters>
            <Setter Property="Background" Value="{DynamicResource GlobalBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource GlobalForegroundBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Expander">
                        <Border BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <DockPanel>
                                <!-- 头部区域 -->
                                <ContentPresenter DockPanel.Dock="Top"
                                                  Content="{TemplateBinding Header}"
                                                  ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                <!-- 内容区域（添加名称用于控制） -->
                                <ContentPresenter x:Name="ExpanderContent"
                                                  DockPanel.Dock="Bottom"
                                                  Content="{TemplateBinding Content}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  Visibility="Collapsed"/>
                            </DockPanel>
                        </Border>

                        <!-- 关键：添加触发器，根据IsExpanded控制内容显示 -->
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="True">
                                <Setter TargetName="ExpanderContent" Property="Visibility" Value="Visible"/>
                                <!-- 可选：添加展开动画 -->
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation
                                                Storyboard.TargetName="ExpanderContent"
                                                Storyboard.TargetProperty="Opacity"
                                                From="0" To="1" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style.Setters>
    </Style>
</ResourceDictionary>